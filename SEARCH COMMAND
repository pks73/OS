#include <string.h>

void search(char *option, char *filename, char *pattern) {
    FILE *fp = fopen(filename, "r");
    char line[100];
    int count = 0, line_no = 0, found = 0;
    
    if(fp == NULL) {
        printf("File not found\n");
        return;
    }
    
    while(fgets(line, sizeof(line), fp)) {
        line_no++;
        if(strstr(line, pattern) != NULL) {
            if(strcmp(option, "a") == 0) {
                printf("Line %d: %s", line_no, line);
                found = 1;
            }
            else if(strcmp(option, "f") == 0) {
                printf("First occurrence at line %d: %s", line_no, line);
                fclose(fp);
                return;
            }
            else if(strcmp(option, "c") == 0) {
                count++;
            }
        }
    }
    
    if(strcmp(option, "c") == 0) {
        printf("Pattern found %d times\n", count);
    }
    else if(!found) {
        printf("Pattern not found\n");
    }
    fclose(fp);
}

// In main shell:
if(strcmp(args[0], "search") == 0) {
    search(args[1], args[2], args[3]);
    continue;
}
