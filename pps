#include<stdio.h>

int main() {
    int n;
    printf("Enter number of processes: ");
    scanf("%d", &n);
    
    int pid[n], AT[n], BT[n], priority[n], WT[n], TAT[n], CT[n], remaining[n], completed[n];
    
    for(int i=0; i<n; i++) {
        pid[i] = i+1;
        printf("Enter arrival time for P%d: ", i+1);
        scanf("%d", &AT[i]);
        printf("Enter burst time for P%d: ", i+1);
        scanf("%d", &BT[i]);
        printf("Enter priority for P%d: ", i+1);
        scanf("%d", &priority[i]);
        completed[i] = 0;
        remaining[i] = BT[i];
    }
    
    int current_time = 0;
    int total_completed = 0;
    int total_WT = 0;
    int total_TAT = 0;
    int P_S= -1;
    
    printf("\nGantt Chart:\n");
    printf("%d", current_time);
    
    while(total_completed < n) {
        int highest_priority = 9999;
        int S_P= -1;
        
        for(int i=0; i<n; i++) {
            if(AT[i] <= current_time && completed[i] == 0) {
                if(priority[i] < highest_priority) {
                    highest_priority = priority[i];
                    S_P= i;
                }
                if(priority[i] == highest_priority) {
                    if(AT[i] < AT[S_P]) {
                        S_P= i;
                    }
                }
            }
        }
        
        if(S_P== -1) {
            current_time++;
            continue;
        }
        
        if(P_S!= S_P) {
            printf(" -> P%d -> %d", pid[S_P], current_time);
        }
        
        remaining[S_P]--;
        current_time++;
        
        if(remaining[S_P] == 0) {
            CT[S_P] = current_time;
            TAT[S_P] = CT[S_P] - AT[S_P];
            WT[S_P] = TAT[S_P] - BT[S_P];
            completed[S_P] = 1;
            
            total_WT += WT[S_P];
            total_TAT += TAT[S_P];
            total_completed++;
            
            printf(" -> P%d -> %d", pid[S_P], current_time);
        }
        
        P_S= S_P;
    }
    
    printf("\n\nProcess Table:\n");
    printf("PID\tAT\tBT\tPriority\tCT\tTAT\tWT\n");
    for(int i=0; i<n; i++) {
        printf("P%d\t%d\t%d\t%d\t\t%d\t%d\t%d\n", 
               pid[i], AT[i], BT[i], priority[i],
               CT[i], TAT[i], WT[i]);
    }
    
    printf("\nAverage TAT: %.2f\n", (float)total_TAT/n);
    printf("Average WT: %.2f\n", (float)total_WT/n);
    
    return 0;
}
